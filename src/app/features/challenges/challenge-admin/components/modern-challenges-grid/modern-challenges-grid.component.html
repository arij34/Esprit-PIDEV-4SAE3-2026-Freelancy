<div class="space-y-6">
  <!-- Challenges Overview Header -->
  <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
    <div class="flex items-center gap-3">
      <button
        (click)="onGoBack()"
        class="p-2 rounded-lg hover:bg-gray-100 transition-colors text-gray-500 hover:text-gray-900">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
        </svg>
      </button>
      <div>
        <h2 class="mb-1 text-xl font-semibold">Challenges Overview</h2>
        <p class="text-gray-600 text-sm">Manage and monitor all your coding challenges ({{ challenges.length }} total)</p>
      </div>
    </div>
    <div class="flex items-center gap-2">
      <button
        (click)="viewMode = 'grid'"
        [class.bg-[#4F46E5]]="viewMode === 'grid'"
        [class.text-white]="viewMode === 'grid'"
        [class.bg-gray-100]="viewMode !== 'grid'"
        [class.text-gray-600]="viewMode !== 'grid'"
        class="p-2 rounded-lg transition-colors">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <rect width="7" height="7" x="3" y="3" rx="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect>
          <rect width="7" height="7" x="14" y="3" rx="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect>
          <rect width="7" height="7" x="14" y="14" rx="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect>
          <rect width="7" height="7" x="3" y="14" rx="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect>
        </svg>
      </button>
      <button
        (click)="viewMode = 'list'"
        [class.bg-[#4F46E5]]="viewMode === 'list'"
        [class.text-white]="viewMode === 'list'"
        [class.bg-gray-100]="viewMode !== 'list'"
        [class.text-gray-600]="viewMode !== 'list'"
        class="p-2 rounded-lg transition-colors">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <rect width="7" height="7" x="3" y="3" rx="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect>
          <rect width="7" height="7" x="3" y="14" rx="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect>
          <path d="M14 4h7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
          <path d="M14 9h7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
          <path d="M14 15h7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
          <path d="M14 20h7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Filters Card -->
  <div class="bg-white rounded-xl border border-gray-200 p-4">
    <div class="flex items-center gap-2 mb-3">
      <svg class="w-4 h-4 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z"></path>
      </svg>
      <span class="text-sm font-medium">Filters</span>
    </div>
    <div class="flex flex-wrap gap-3">
      <select
        [(ngModel)]="filterCategory"
        (ngModelChange)="onFilterChange()"
        class="px-3 py-2 border border-gray-200 rounded-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-[#4F46E5]/20">
        <option value="all">All Categories</option>
        <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
      </select>
      <select
        [(ngModel)]="filterStatus"
        (ngModelChange)="onFilterChange()"
        class="px-3 py-2 border border-gray-200 rounded-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-[#4F46E5]/20">
        <option value="all">All Status</option>
        <option *ngFor="let status of statuses" [value]="status">{{ status }}</option>
      </select>
      <select
        [(ngModel)]="filterDifficulty"
        (ngModelChange)="onFilterChange()"
        class="px-3 py-2 border border-gray-200 rounded-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-[#4F46E5]/20">
        <option value="all">All Difficulty</option>
        <option *ngFor="let diff of difficulties" [value]="diff">{{ diff }}</option>
      </select>
    </div>
  </div>

  <!-- Grid View -->
  <div *ngIf="viewMode === 'grid'" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5">
    <div
      *ngFor="let challenge of filteredChallenges; trackBy: trackByChallenge"
      class="bg-white rounded-lg border border-gray-200 overflow-hidden hover:shadow-lg transition-all duration-300 group flex flex-col">
      <div class="relative h-44 overflow-hidden bg-gradient-to-br from-[#4F46E5]/10 to-[#22D3EE]/10">
        <img
          *ngIf="challenge.image"
          [src]="challenge.image"
          [alt]="challenge.title"
          class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
        />
        <div *ngIf="!challenge.image" class="w-full h-full flex items-center justify-center">
          <svg class="w-12 h-12 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526"></path>
            <circle cx="12" cy="8" r="6"></circle>
          </svg>
        </div>
        <div class="absolute top-2 left-2">
          <div [class]="'px-2 py-0.5 rounded-full text-[10px] ' + getStatusColor(challenge.status)">{{ challenge.status }}</div>
        </div>
        <div class="absolute top-2 right-2">
          <div [class]="'px-2 py-0.5 rounded-full text-[10px] ' + getDifficultyColor(challenge.difficulty)">{{ challenge.difficulty || 'N/A' }}</div>
        </div>
      </div>
      <div class="px-4 py-5 flex flex-col flex-1">
        <div class="mb-2">
          <h3 class="mb-1 line-clamp-2 min-h-[2.5rem] font-medium text-base">{{ challenge.title }}</h3>
          <p class="text-sm text-gray-600 line-clamp-2">{{ challenge.description || 'No description provided' }}</p>
        </div>
        <div class="mb-2">
          <span class="text-[10px] text-[#4F46E5] bg-[#4F46E5]/5 px-1.5 py-0.5 rounded">{{ challenge.category || 'Uncategorized' }}</span>
        </div>
        <div class="flex flex-wrap gap-1 mb-2" *ngIf="getTechnologyArray(challenge).length > 0">
          <span *ngFor="let tech of getTechnologyArray(challenge)" class="text-[10px] bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded">{{ tech }}</span>
        </div>
        <div class="mt-auto">
        <div class="flex items-center gap-3 mb-2 pb-2 border-b border-gray-100 text-xs">
          <div class="flex items-center gap-1">
            <svg class="w-3 h-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
            </svg>
            <span class="text-gray-600">{{ challenge.participants || 0 }}</span>
          </div>
          <div class="flex items-center gap-1">
            <svg class="w-3 h-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526"></path>
              <circle cx="12" cy="8" r="6"></circle>
            </svg>
            <span class="text-gray-600">{{ challenge.points || 0 }} pts</span>
          </div>
          <span class="ml-auto text-[#4F46E5] font-medium">{{ getCompletionRate(challenge) }}%</span>
        </div>
        <div class="mb-2">
          <div class="h-1.5 bg-gray-100 rounded-full overflow-hidden">
            <div class="h-full bg-gradient-to-r from-[#4F46E5] to-[#22D3EE] transition-all rounded-full" [style.width.%]="getCompletionRate(challenge)"></div>
          </div>
        </div>
        <div class="flex gap-2">
          <button
            (click)="onView(challenge)"
            class="flex-1 px-2 py-1.5 bg-[#4F46E5] text-white rounded-md hover:bg-[#4F46E5]/90 transition-colors text-xs flex items-center justify-center gap-1">
            <svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
            View
          </button>
          <button (click)="onEdit(challenge)" class="px-2 py-1.5 border border-gray-200 rounded-md hover:bg-gray-100 transition-colors" title="Edit">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"></path>
            </svg>
          </button>
          <button (click)="onDuplicate(challenge)" class="px-2 py-1.5 border border-gray-200 rounded-md hover:bg-gray-100 transition-colors" title="Duplicate">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <rect width="14" height="14" x="8" y="8" rx="2" ry="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></rect>
              <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
          </button>
          <button (click)="onViewParticipants(challenge)" class="px-2 py-1.5 border border-gray-200 rounded-md hover:bg-gray-100 transition-colors" title="View Participants">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
          </button>
          <button (click)="onDelete(challenge)" class="px-2 py-1.5 border border-gray-200 rounded-md hover:bg-red-50 hover:border-red-200 hover:text-red-600 transition-colors" title="Delete">
            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11v6M14 11v6"></path>
            </svg>
          </button>
        </div>
        </div>
      </div>
    </div>
  </div>

  <!-- List View -->
  <div *ngIf="viewMode === 'list'" class="space-y-4">
    <div
      *ngFor="let challenge of filteredChallenges; trackBy: trackByChallenge"
      class="bg-white border border-gray-200 rounded-xl p-5 hover:shadow-lg transition-shadow">
      <div class="flex items-center gap-5">
        <div class="w-32 h-32 bg-gradient-to-br from-[#4F46E5]/10 to-[#22D3EE]/10 rounded-lg overflow-hidden flex-shrink-0">
          <img *ngIf="challenge.image" [src]="challenge.image" [alt]="challenge.title" class="w-full h-full object-cover" />
          <div *ngIf="!challenge.image" class="w-full h-full flex items-center justify-center">
            <svg class="w-12 h-12 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526"></path>
              <circle cx="12" cy="8" r="6"></circle>
            </svg>
          </div>
        </div>
        <div class="flex-1 min-w-0">
          <div class="flex items-start justify-between gap-4 mb-2">
            <div class="flex-1 min-w-0">
              <h3 class="text-lg mb-1 truncate">{{ challenge.title }}</h3>
              <p class="text-sm text-gray-600 line-clamp-2 mb-2">{{ challenge.description || 'No description provided' }}</p>
              <div class="flex items-center gap-2 flex-wrap">
                <span [class]="'px-2 py-0.5 rounded-full text-white text-xs ' + getStatusColor(challenge.status)">{{ challenge.status }}</span>
                <span [class]="'px-2 py-0.5 rounded-full text-xs ' + getDifficultyColor(challenge.difficulty)">{{ challenge.difficulty }}</span>
                <span class="text-xs text-[#4F46E5] bg-[#4F46E5]/5 px-2 py-1 rounded">{{ challenge.category }}</span>
              </div>
            </div>
            <div class="flex gap-2 flex-shrink-0">
              <button (click)="onView(challenge)" class="px-3 py-2 bg-[#4F46E5] text-white rounded-lg hover:bg-[#4F46E5]/90 text-sm flex items-center gap-1">View</button>
              <button (click)="onEdit(challenge)" class="p-2 border border-gray-200 rounded-lg hover:bg-gray-100" title="Edit">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z"></path></svg>
              </button>
              <button (click)="onDuplicate(challenge)" class="p-2 border border-gray-200 rounded-lg hover:bg-gray-100" title="Duplicate">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg>
              </button>
              <button (click)="onViewParticipants(challenge)" class="p-2 border border-gray-200 rounded-lg hover:bg-gray-100" title="View Participants">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M22 21v-2a4 4 0 0 0-3-3.87"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
              </button>
              <button (click)="onDelete(challenge)" class="p-2 border border-gray-200 rounded-lg hover:bg-red-50 hover:border-red-200 hover:text-red-600 transition-colors" title="Delete">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11v6M14 11v6"></path>
                </svg>
              </button>
            </div>
          </div>
          <div class="flex items-center gap-6 text-sm text-gray-600 mt-3">
            <div class="flex items-center gap-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle></svg><span>{{ challenge.participants || 0 }} participants</span></div>
            <div class="flex items-center gap-1"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526"></path><circle cx="12" cy="8" r="6"></circle></svg><span>{{ challenge.points || 0 }} points</span></div>
            <div class="flex items-center gap-1 text-[#4F46E5]"><span>{{ getCompletionRate(challenge) }}% completion</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="filteredChallenges.length === 0" class="text-center py-16 bg-white rounded-xl border border-gray-200">
    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
      <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526"></path>
        <circle cx="12" cy="8" r="6"></circle>
      </svg>
    </div>
    <h3 class="text-lg mb-2">No challenges found</h3>
    <p class="text-sm text-gray-600">Try adjusting your filter criteria</p>
  </div>
</div>
